(this.webpackJsonpopenhart=this.webpackJsonpopenhart||[]).push([[0],{119:function(e,t,s){"use strict";s.r(t);var n=s(1),a=s.n(n),r=s(17),c=s.n(r),i=(s(58),s(31)),o=s(22),l=s(37),h=s(53),d=s(18),p=s(19),u=s(21),j=s(20),m=(s(59),s(28)),b=s(27),f=s(10),g=s.p+"static/media/logo.678c83d1.svg",O=s(3),v=s(72),x=s(73),w=new m.c({defaultHeight:100,fixedWidth:!0});function k(e){return x.emojify(e,(function(e){switch(e){case"face_with_symbols_over_mouth":return x.get(":face_with_symbols_on_mouth:");case"rofl":return x.get(":rolling_on_the_floor_laughing:");default:return e}}))}function y(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var N=function(e){Object(u.a)(s,e);var t=Object(j.a)(s);function s(){return Object(d.a)(this,s),t.apply(this,arguments)}return Object(p.a)(s,[{key:"render",value:function(){var e=this.props.text,t=[];if(void 0!==this.props.type)switch(this.props.type){case"au":t.push(Object(O.jsxs)("span",{className:"t",children:["user ",Object(O.jsx)("em",{children:e})," added by ",Object(O.jsx)("em",{children:this.props.user.username})]}));break;case"discussion-created":t.push(Object(O.jsxs)("span",{className:"t",children:["created a discussion: ",Object(O.jsx)("em",{children:e})]}));break;case"message_pinned":t.push(Object(O.jsxs)("span",{className:"t",children:["pinned a message: ",Object(O.jsx)("em",{children:e})]}));break;case"r":t.push(Object(O.jsxs)("span",{className:"t",children:["room name changed to ",Object(O.jsx)("em",{children:e})," by ",Object(O.jsx)("em",{children:this.props.user.username})]}));break;case"rm":t.push(Object(O.jsx)("span",{className:"t",children:"message removed"}));break;case"room_changed_announcement":t.push(Object(O.jsxs)("span",{className:"t",children:["room announcement changed to ",Object(O.jsx)("em",{children:e||"(none)"})," by ",Object(O.jsx)("em",{children:this.props.user.username})]}));break;case"room_changed_description":t.push(Object(O.jsxs)("span",{className:"t",children:["room description changed to ",Object(O.jsx)("em",{children:e||"(none)"})," by ",Object(O.jsx)("em",{children:this.props.user.username})]}));break;case"room_changed_privacy":t.push(Object(O.jsxs)("span",{className:"t",children:["room type changed to ",Object(O.jsx)("em",{children:e})," by ",Object(O.jsx)("em",{children:this.props.user.username})]}));break;case"room_changed_topic":t.push(Object(O.jsxs)("span",{className:"t",children:["room topic changed to ",Object(O.jsx)("em",{children:e||"(none)"})," by ",Object(O.jsx)("em",{children:this.props.user.username})]}));break;case"ru":t.push(Object(O.jsxs)("span",{className:"t",children:["user ",Object(O.jsx)("em",{children:e})," removed by ",Object(O.jsx)("em",{children:this.props.user.username})]}));break;case"uj":t.push(Object(O.jsx)("span",{className:"t",children:"has joined the channel"}));break;case"ul":t.push(Object(O.jsx)("span",{className:"t",children:"has left the channel"}));break;case"ut":t.push(Object(O.jsx)("span",{className:"t",children:"has joined the conversation"}));break;default:t.push(Object(O.jsxs)("span",{className:"t",children:[this.props.type,":",Object(O.jsx)("em",{children:e})]}))}else if(e=k(e),null!==this.props.filter){var s,n=e.matchAll(this.props.filter.regexp),a=0,r=0,c=Object(h.a)(n);try{for(c.s();!(s=c.n()).done;){var i=s.value;i.index>a&&(t.push(Object(O.jsx)("span",{children:e.slice(a,i.index)},this.props.id+"-"+ ++r)),a=i.index),t.push(Object(O.jsx)("span",{className:"highlight",children:i[0]},this.props.id+"-"+ ++r)),a+=i[0].length}}catch(u){c.e(u)}finally{c.f()}a<e.length&&t.push(Object(O.jsx)("span",{children:e.slice(a)},this.props.id+"-"+ ++r))}else t=[Object(O.jsx)("span",{children:e})];if(1===t.length&&(t=t[0]),void 0===this.props.user)return null;var o=["message"];this.props.type&&(o.push("t"),o.push(this.props.type)),this.props.active&&o.push("active");var d=[];if(void 0!==this.props.reactions)for(var p in this.props.reactions)d.push({reaction:p,reactors:this.props.reactions[p]});return Object(O.jsxs)("div",{className:o.join(" "),id:this.props.id,children:[Object(O.jsx)("div",{className:"avatar",children:Object(O.jsx)("img",{src:"/app/avatars/"+this.props.user.avatar,alt:this.props.user.name})}),Object(O.jsxs)("div",{className:"data",children:[Object(O.jsxs)("div",{className:"meta",children:[Object(O.jsx)("div",{className:"name",children:this.props.user.name}),Object(O.jsx)("div",{className:"username",children:this.props.user.username}),Object(O.jsx)("div",{className:"ts",children:new Date(this.props.ts).toISOString()}),Object(O.jsx)("div",{className:"channel",children:Object(O.jsxs)(b.b,{to:"/channel/"+this.props.channel.id+"/"+this.props.id,children:["#",this.props.channel.name]})}),Object(O.jsx)("div",{className:"link",children:Object(O.jsx)(b.b,{to:"/channel/"+this.props.channel.id+"/"+this.props.id,children:x.get(":link:")})})]}),Object(O.jsx)("div",{className:"text",children:t}),Object(O.jsx)(C,{attachments:this.props.attachments,messageId:this.props.id}),Object(O.jsx)("div",{className:"reactions",children:d.map((function(e){return Object(O.jsx)(I,Object(l.a)({"data-tip":e.reactors,"data-event":"click focus"},e),e.reaction)}))})]})]})}}]),s}(a.a.Component),C=function(e){Object(u.a)(s,e);var t=Object(j.a)(s);function s(){return Object(d.a)(this,s),t.apply(this,arguments)}return Object(p.a)(s,[{key:"render",value:function(){var e=this;return void 0===this.props.attachments?null:Object(O.jsx)("div",{className:"attachments",children:this.props.attachments.map((function(t,s){return Object(O.jsx)("div",{className:"attachment",children:Object(O.jsx)("div",{className:"name",children:Object(O.jsx)("span",{children:t.name})})},"attachment"+e.props.messageId+"-"+s)}))})}}]),s}(a.a.Component),I=function(e){Object(u.a)(s,e);var t=Object(j.a)(s);function s(){return Object(d.a)(this,s),t.apply(this,arguments)}return Object(p.a)(s,[{key:"render",value:function(){return Object(O.jsxs)("div",{className:"reaction",children:[Object(O.jsx)("div",{className:"emoji",title:this.props.reaction,children:k(this.props.reaction)}),Object(O.jsx)("div",{className:"users",children:this.props.reactors.map((function(e){return Object(O.jsxs)("span",{className:"user",children:["@",e]},e)}))})]})}}]),s}(a.a.Component),_=function(e){Object(u.a)(s,e);var t=Object(j.a)(s);function s(e){var n;return Object(d.a)(this,s),(n=t.call(this,e)).rowRenderer=n.rowRenderer.bind(Object(o.a)(n)),n.list=a.a.createRef(),n}return Object(p.a)(s,[{key:"rowRenderer",value:function(e){var t=this,s=e.index,n=(e.isScrolling,e.key),a=e.parent,r=e.style;return Object(O.jsx)(m.b,{cache:w,columnIndex:0,parent:a,rowIndex:s,children:function(e){e.measure;var n=e.registerChild;return Object(O.jsx)("div",{ref:n,style:r,children:Object(O.jsx)(N,Object(l.a)({active:t.props.messages[s].id===t.props.messageId,filter:t.props.filter},t.props.messages[s]))})}},n)}},{key:"render",value:function(){var e=this;w.clearAll();var t=0;if(void 0!==this.props.messageId)for(var s=0;s<this.props.messages.length;s++)if(this.props.messages[s].id===this.props.messageId){t=s;break}return Object(O.jsx)("div",{className:"list",children:Object(O.jsx)(m.a,{onResize:function(t){t.width,t.height;w.clearAll(),e.list.current.forceUpdateGrid(),e.list.current.recomputeRowHeights()},children:function(s){var n=s.height,a=s.width;return Object(O.jsx)(m.d,{width:a,height:n,rowCount:e.props.messages.length,rowHeight:w.rowHeight,rowRenderer:e.rowRenderer,deferredMeasurementCache:w,scrollToIndex:t,ref:e.list})}})})}}]),s}(a.a.Component),R=function(e){Object(u.a)(s,e);var t=Object(j.a)(s);function s(e){var n;return Object(d.a)(this,s),(n=t.call(this,e)).state={value:null},n.ref=a.a.createRef(),n.onChange=n.onChange.bind(Object(o.a)(n)),n}return Object(p.a)(s,[{key:"onChange",value:function(){var e=this.ref.current.value;e!==this.state.value&&(this.setState({value:e}),void 0!==this.props.onChange&&this.props.onChange(e))}},{key:"render",value:function(){return Object(O.jsx)("div",{className:"search",children:Object(O.jsx)("input",{ref:this.ref,type:"search",placeholder:"search",onChange:this.onChange})})}}]),s}(a.a.Component),S=function(e){Object(u.a)(s,e);var t=Object(j.a)(s);function s(){return Object(d.a)(this,s),t.apply(this,arguments)}return Object(p.a)(s,[{key:"render",value:function(){var e=this,t=[{id:"all",name:"all",ts:0}].concat(this.props.channels);return Object(O.jsx)("div",{className:"channels",children:t.map((function(t){var s=["channel"];return e.props.channelId===t.id&&s.push("active"),t.ts>1627775999e3&&s.push("updated"),s=s.join(" "),Object(O.jsx)(b.b,{to:"/channel/"+t.id,className:s,title:t.name||t.id,children:t.name||t.id},t.id)}))})}}]),s}(a.a.Component),W=function(e){Object(u.a)(s,e);var t=Object(j.a)(s);function s(e){var n;return Object(d.a)(this,s),(n=t.call(this,e)).state={data:null,filter:null},n.onFilterChanged=v.debounce(n.onFilterChanged.bind(Object(o.a)(n)),500),n.filteredMessages=n.filteredMessages.bind(Object(o.a)(n)),n}return Object(p.a)(s,[{key:"componentDidMount",value:function(){var e=this;fetch("/app/data.json").then((function(e){return e.json()})).then((function(t){function s(e){return e.split("").map((function(e){return s.lookup[e]||e})).join("")}s.i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),s.o="HO326I4pkDUaj9KGF05VEbtu1qvWeyAJRZsXBLofSdwlxC8hzrc7PnYMNQgiTm".split(""),s.lookup=s.i.reduce((function(e,t,n){return Object.assign(e,Object(i.a)({},t,s.o[n]))}),{});var n={},a={};t.channels.forEach((function(e){e.name=s(e.name),n[e.id]=e})),t.users.forEach((function(e){e.name=s(e.name),e.username=s(e.username),a[e.id]=e})),t.messages.forEach((function(e){if(e.text=s(e.text),void 0!==e.attachments&&e.attachments.forEach((function(e){e.name=s(e.name)})),void 0!==e.reactions)for(var r in e.reactions)e.reactions[r]=e.reactions[r].map(s);void 0!==n[e.channel.id]?e.channel=n[e.channel.id]:t.channels.push(n[e.channel.id]={id:e.channel.id,name:e.channel.id}),e.user=a[e.user.id]})),e.setState({data:t})}))}},{key:"onFilterChanged",value:function(e){if(e){(e={string:e}).string=e.string.replace(/\s*\b(\w+):(\S*)/g,(function(t,s,n){switch(s){case"after":n=Date.parse(n),isNaN(n)||(e.after=n);break;case"before":n=Date.parse(n),isNaN(n)||(e.before=n);break;case"user":try{e.user=new RegExp(n,"i")}catch(a){e.user=new RegExp(y(n),"i")}break;default:return t}return""}));try{e.regexp=new RegExp(e.string,"gi")}catch(t){e.regexp=new RegExp(y(e.string),"gi")}}else e=null;this.setState({filter:e})}},{key:"filteredMessages",value:function(){var e=this;return setTimeout((function(){w.clearAll()}),0),this.state.data.messages.filter((function(t){return("all"===e.props.channelId||t.channel.id===e.props.channelId)&&(null===e.state.filter||function(e,t){return!(void 0!==e.after&&t.ts<e.after)&&(!(void 0!==e.before&&t.ts>=e.before)&&(!(void 0!==e.user&&!e.user.test(t.user.username)&&!e.user.test(t.user.name))&&(e.regexp.test(t.text)||e.regexp.test(t.user.name)||e.regexp.test(t.user.username)||e.regexp.test("@"+t.user.username)||e.regexp.source.length>=17&&e.regexp.test(t.id))))}(e.state.filter,t))}))}},{key:"render",value:function(){return null===this.state.data?Object(O.jsx)("div",{className:"loading",children:Object(O.jsx)("img",{src:g,alt:"logo"})}):Object(O.jsxs)("div",{className:"chat",children:[Object(O.jsx)(S,{channels:this.state.data.channels,channelId:this.props.channelId}),Object(O.jsxs)("div",{className:"messages",id:"messages-"+this.props.channelId,children:[Object(O.jsx)(_,{filter:this.state.filter,messages:this.filteredMessages(),messageId:this.props.messageId}),Object(O.jsx)(R,{onChange:this.onFilterChanged})]})]})}}]),s}(a.a.Component);function E(){var e=Object(f.g)(),t=e.channel,s=e.message;return Object(O.jsx)(W,{channelId:t,messageId:s})}var F=function(){return Object(O.jsx)("div",{className:"App",children:Object(O.jsx)(b.a,{children:Object(O.jsxs)(f.d,{children:[Object(O.jsx)(f.b,{path:"/channel/:channel/:message",children:Object(O.jsx)(E,{})}),Object(O.jsx)(f.b,{path:"/channel/:channel",children:Object(O.jsx)(E,{})}),Object(O.jsx)(f.b,{exact:!0,path:"/",children:Object(O.jsx)(f.a,{to:"/channel/all"})})]})})})};console.log("%c\u2763\ufe0f%c"+atob("I2hhcnRsZWFrcw==")+"%c\n"+atob("aHR0cHM6Ly9naXRodWIuY29tL29wZW5oYXJ0L2FwcC1zcmM="),"font: 6em emoji; color: red; padding: 0.5em;","color: blue; font-size: 3em;","font-size: 2em;");var M=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function A(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var s=e.installing;null!=s&&(s.onstatechange=function(){"installed"===s.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var L=function(e){e&&e instanceof Function&&s.e(3).then(s.bind(null,120)).then((function(t){var s=t.getCLS,n=t.getFID,a=t.getFCP,r=t.getLCP,c=t.getTTFB;s(e),n(e),a(e),r(e),c(e)}))};c.a.render(Object(O.jsx)(a.a.StrictMode,{children:Object(O.jsx)(F,{})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/app",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/app","/service-worker.js");M?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(s){var n=s.headers.get("content-type");404===s.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):A(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):A(t,e)}))}}(),L()},58:function(e,t,s){},59:function(e,t,s){}},[[119,1,2]]]);